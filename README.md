
---

# üõ°Ô∏è Fitness App Auth API

**Fitness App Auth API** ‚Äî —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –¥–ª—è —Ñ–∏—Ç–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –¥—Ä—É–∂–±–æ–π, gRPC-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ RabbitMQ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π. —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Fly.io**, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **PostgreSQL** –≤ –æ–±–ª–∞–∫–µ **Neon**, –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **GitHub Actions**, –∞ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ **Grafana + Prometheus** –Ω–∞ Fly.io.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üåê REST API (JSON)

* **AuthController**:

  * –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (`/register`) ‚Äî email, –ø–∞—Ä–æ–ª—å, nickname (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ email)
  * –õ–æ–≥–∏–Ω (`/login`) ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç access –∏ refresh —Ç–æ–∫–µ–Ω—ã
  * –õ–æ–≥–∞—É—Ç (`/logout`) ‚Äî –¥–µ–ª–∞–µ—Ç refresh-—Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º
  * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (`/refresh`) ‚Äî –ø–æ refresh-—Ç–æ–∫–µ–Ω—É –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏ access, –∏ refresh —Ç–æ–∫–µ–Ω—ã
  * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ (`/validate`) ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ access-—Ç–æ–∫–µ–Ω–∞
* **FriendshipsController**:

  * –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ –¥—Ä—É–∑—å—è –ø–æ –ª–æ–≥–∏–Ω—É
  * –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å (–ø—Ä–∏–Ω—è—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å)
  * –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥—Ä—É–∑—å—è (—Ç–≤–æ–∏—Ö –∏ –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–±–µ)
  * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π
  * –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –¥—Ä—É–∑–µ–π
* **UserController**:

  * –°–º–µ–Ω–∞ –Ω–∏–∫–∞
  * –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  * –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ email –∏–ª–∏ username)

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

---

### üîó gRPC-—Å–µ—Ä–≤–µ—Ä (Protobuf)

* **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ JWT**:

  * –ü—Ä–∏–Ω–∏–º–∞–µ—Ç JWT, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `id`, `email`, `username`
  * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö Workout –∏ Notification
* **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–∂–±—ã**:

  * –ü–æ `user_id` –∏ `friend_username`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `friend_id` –∏ `email`
  * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Workout
* **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID**:

  * –ü–æ `user_id`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### üêá RabbitMQ Producer

* **–°–æ–±—ã—Ç–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**:

  * **–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ –¥—Ä—É–∑—å—è** ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
  * **–û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –≤ –¥—Ä—É–∑—å—è** ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–Ω—è—Ç–∏–∏/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏
* **–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π (JSON)**:

  ```json
    {
    "type": "friend_invite",
    "senderName": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "recipientEmail": "exmample@mail.ru",
    "action": "accept"
    }
  ```

---

### ‚òÅÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –¥–µ–ø–ª–æ–π

* üöÄ **–î–µ–ø–ª–æ–π –Ω–∞ Fly.io** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Fly.io –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ —Å–µ—Ä–≤–∏—Å–∞
* üîí **–°–µ–∫—Ä–µ—Ç—ã —á–µ—Ä–µ–∑ Fly Secrets** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ç–æ–∫–µ–Ω–æ–≤
* üìä **–ú–µ—Ç—Ä–∏–∫–∏** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ Prometheus + Grafana –Ω–∞ Fly.io
* üì¶ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äî PostgreSQL –Ω–∞ –æ–±–ª–∞—á–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ **Neon**
* üîÑ **CI/CD —á–µ—Ä–µ–∑ GitHub Actions** ‚Äî –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π –ø—Ä–∏ –ø—É—à–∞—Ö –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

### üë• –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

#### User

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
**–ü–æ–ª—è:**

| –ü–æ–ª–µ               | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö         | –û–ø–∏—Å–∞–Ω–∏–µ                                                   |
| ------------------ | ------------------ | ---------------------------------------------------------- |
| `Id`               | `Guid`             | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                      |
| `Email`            | `string`           | Email (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)                                         |
| `PasswordHash`     | `string`           | –•—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å                                        |
| `Username`         | `string`           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–∏–∫–Ω–µ–π–º (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) |
| `RegistrationDate` | `DateTime`         | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏                                           |
| `Friendships`      | `List<Friendship>` | –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–¥—Ä—É–∂–±–∞)                    |

#### Friendship

–°–≤—è–∑—å –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–∑–∞–ø—Ä–æ—Å –≤ –¥—Ä—É–∑—å—è).
**–ü–æ–ª—è:**

| –ü–æ–ª–µ       | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ                                               |
| ---------- | ---------- | ------------------------------------------------------ |
| `Id`       | `Guid`     | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏ –¥—Ä—É–∂–±—ã                 |
| `UserId`   | `Guid`     | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å |
| `FriendId` | `Guid`     | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥—Ä—É–≥–∞                                    |
| `Status`   | `enum`     | –°—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞ (`Pending`, `Accepted`, `Rejected`)     |

**FriendshipStatus** (enum):

* `Pending` ‚Äî –∑–∞–ø—Ä–æ—Å –æ–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞
* `Accepted` ‚Äî –∑–∞–ø—Ä–æ—Å –ø—Ä–∏–Ω—è—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å—Ç–∞–ª–∏ –¥—Ä—É–∑—å—è–º–∏
* `Rejected` ‚Äî –∑–∞–ø—Ä–æ—Å –æ—Ç–∫–ª–æ–Ω—ë–Ω

---
